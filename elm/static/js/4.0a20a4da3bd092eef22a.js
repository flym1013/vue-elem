webpackJsonp([4],{JVEZ:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("gRE1"),r=e.n(a),i=e("Dd8w"),n=e.n(i),o=e("Xxa5"),c=e.n(o),_=e("exGp"),d=e.n(_),u=e("hxP8"),l=e("Uoa1"),h=e("NYxO"),p=e("i84Q"),v={data:function(){return{geohash:"",shopId:null,showLoading:!0,checkoutData:{cart:[],invoice:[]},shopCart:null,imgBaseUrl:"http://cangdu.org:8001/img/",showPayWay:!1,payWayId:1,showAlert:!1,alertText:null,payMethods:null,orderRes:null,addressRes:[]}},created:function(){var t=this;return d()(c.a.mark(function s(){return c.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t.geohash=t.$route.query.geohash,t.shopId=t.$route.query.shopId,t.INIT_BUYCART(),t.SAVE_SHOPID(t.shopId),t.shopCart=t.cartList[t.shopId],!t.geohash){s.next=9;break}return s.next=8,t.init();case 8:t.SAVE_GEOHASH(t.geohash);case 9:case"end":return s.stop()}},s,t)}))()},mouted:function(){},computed:n()({},Object(h.d)(["cartList","remarkText","inputText","invoice","choosedAddress","userInfo","invoiceTxt"]),{remarklist:function(){var t="";return this.remarkText&&r()(this.remarkText).forEach(function(s){t+=s[1]+"，"}),this.inputText?t+this.inputText:t.substr(0,t.lastIndexOf("，"))}}),components:{headerTop:u.a,alertTip:l.a},watch:{userInfo:function(t){t&&t.user_id&&this.initAddress()}},methods:n()({},Object(h.c)(["INIT_BUYCART","SAVE_GEOHASH","CHOOSE_ADDRESS","NEED_VALIDATION","SAVE_CART_ID_SIG","SAVE_ORDER_PARAM","ORDER_SUCCESS","SAVE_SHOPID"]),{init:function(){var t=this;return d()(c.a.mark(function s(){var e;return c.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e=[],r()(t.shopCart).forEach(function(t){r()(t).forEach(function(t){r()(t).forEach(function(t){e.push({attrs:[],extra:{},id:t.id,name:t.name,packing_fee:t.packing_fee,price:t.price,quantity:t.num,sku_id:t.sku_id,specs:[t.specs],stock:t.stock})})})}),s.next=4,t.checkout(e);case 4:t.initAddress();case 5:case"end":return s.stop()}},s,t)}))()},checkout:function(t){var s=this;return d()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.c)({restaurant_id:s.shopId,geohash:s.geohash,entities:[t]});case 2:a=e.sent,s.checkoutData=a.data;case 4:case"end":return e.stop()}},e,s)}))()},iconColor:function(t){switch(t){case"公司":return"#4cd964";case"学校":return"#3190e8"}},showPayWayFun:function(){this.showPayWay=!this.showPayWay},choosePayWay:function(t,s,e){t&&(this.showPayWay=!this.showPayWay,this.payWayId=s,this.payMethods=e)},initAddress:function(){var t=this;return d()(c.a.mark(function s(){var e;return c.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!t.userInfo||!t.userInfo.user_id){s.next=6;break}return s.next=3,Object(p.g)({user_id:t.userInfo.user_id});case 3:e=s.sent,t.addressRes=e.data,t.addressRes instanceof Array&&t.addressRes.length&&t.CHOOSE_ADDRESS({address:t.addressRes[0],index:0});case 6:case"end":return s.stop()}},s,t)}))()},confrimOrder:function(){var t=this;return d()(c.a.mark(function s(){var e;return c.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t.userInfo&&t.userInfo.user_id?t.choosedAddress||(t.showAlert=!0,t.alertText="请添加一个收获地址"):(t.showAlert=!0,t.alertText="请登录"),t.SAVE_ORDER_PARAM({user_id:t.userInfo.user_id,cart_id:t.checkoutData.cart.id,address_id:t.choosedAddress.id,description:t.remarklist,entities:t.checkoutData.cart.groups,geohash:t.geohash,sig:t.checkoutData.sig}),s.next=4,Object(p.A)({user_id:t.userInfo.user_id,cart_id:t.checkoutData.cart.id,address_id:t.choosedAddress.id,description:t.remarklist,entities:t.checkoutData.cart.groups,geohash:t.geohash,sig:t.checkoutData.sig});case 4:e=s.sent,t.orderRes=e.data.need_validation,t.orderRes.need_validation?(t.NEED_VALIDATION(t.orderRes),t.$router.push("")):(t.ORDER_SUCCESS(t.orderRes),t.$router.push("/payment"));case 7:case"end":return s.stop()}},s,t)}))()}})},f={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"confirmOrderContainer"},[e("header-Top",{attrs:{"head-title":"确认订单",goBack:"true","signin-up":"confirmOrder"}}),t._v(" "),e("router-link",{staticClass:"address_container",attrs:{to:{path:"/choosedAddress",query:{id:t.checkoutData.cart.id,sig:t.checkoutData.sig}}}},[e("div",{staticClass:"address_empty_left"},[e("svg",{staticClass:"location_icon"},[e("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#location"}})]),t._v(" "),t.choosedAddress?e("div",{staticClass:"address_detail_container"},[e("header",[e("span",[t._v(t._s(t.choosedAddress.name))]),t._v(" "),e("span",[t._v(t._s(1==t.choosedAddress.sex?"先生":"女士"))]),t._v(" "),e("span",[t._v(t._s(t.choosedAddress.phone))])]),t._v(" "),e("div",{staticClass:"address_detail"},[t.choosedAddress.tag?e("span",{style:{backgroundColor:t.iconColor(t.choosedAddress.tag)}},[t._v(t._s(t.choosedAddress.tag))]):t._e(),t._v(" "),e("p",[t._v(t._s(t.choosedAddress.address_detail))])])]):e("div",{staticClass:"add_address"},[t._v("请添加一个收获地址")])]),t._v(" "),e("svg",{staticClass:"address_empty_right"},[e("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#arrow-right"}})])]),t._v(" "),e("section",{staticClass:"delivery_model container_style"},[e("p",{staticClass:"deliver_text"},[t._v("送达时间")]),t._v(" "),e("div",{staticClass:"deliver_time"},[e("p",[t._v("尽快送达 | 预计 "+t._s(t.checkoutData.delivery_reach_time))]),t._v(" "),t.checkoutData.cart.is_deliver_by_fengniao?e("p",[t._v("蜂鸟专送")]):t._e()])]),t._v(" "),e("section",{staticClass:"pay_way container_style"},[e("header",{staticClass:"header_style"},[e("span",[t._v("支付方式")]),t._v(" "),e("div",{staticClass:"more_type",on:{click:t.showPayWayFun}},[null===t.payMethods?e("span",[t._v("在线支付")]):e("span",[t._v(t._s(t.payMethods))]),t._v(" "),e("svg",{staticClass:"address_empty_right"},[e("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#arrow-right"}})])])]),t._v(" "),t._m(0)]),t._v(" "),e("section",{staticClass:"food_list"},[t.checkoutData.cart.restaurant_info?e("header",[e("img",{attrs:{src:t.imgBaseUrl+t.checkoutData.cart.restaurant_info.image_path}}),t._v(" "),e("span",[t._v(t._s(t.checkoutData.cart.restaurant_info.name))])]):t._e(),t._v(" "),t.checkoutData.cart.groups?e("ul",{staticClass:"food_list_ul"},t._l(t.checkoutData.cart.groups[0],function(s){return e("li",{key:s.id,staticClass:"food_item_style"},[e("p",{staticClass:"food_name ellipsis"},[t._v(t._s(s.name))]),t._v(" "),e("div",{staticClass:"num_price"},[e("span",[t._v("x "+t._s(s.quantity))]),t._v(" "),e("span",[t._v("¥"+t._s(s.price))])])])})):t._e(),t._v(" "),t.checkoutData.cart.extra?e("div",{staticClass:"food_item_style"},[e("p",{staticClass:"food_name ellipsis"},[t._v(t._s(t.checkoutData.cart.extra[0].name))]),t._v(" "),e("div",{staticClass:"num_price"},[e("span"),t._v(" "),e("span",[t._v("¥ "+t._s(t.checkoutData.cart.extra[0].price))])])]):t._e(),t._v(" "),e("div",{staticClass:"food_item_style"},[e("p",{staticClass:"food_name ellipsis"},[t._v("配送费")]),t._v(" "),e("div",{staticClass:"num_price"},[e("span"),t._v(" "),e("span",[t._v("¥ "+t._s(t.checkoutData.cart.deliver_amount||0))])])]),t._v(" "),e("div",{staticClass:"food_item_style total_price"},[e("p",{staticClass:"food_name ellipsis"},[t._v("订单 ¥"+t._s(t.checkoutData.cart.total))]),t._v(" "),e("div",{staticClass:"num_price"},[e("span",[t._v("待支付 ¥"+t._s(t.checkoutData.cart.total))])])])]),t._v(" "),e("section",{staticClass:"pay_way container_style"},[e("router-link",{staticClass:"header_style",attrs:{to:{path:"/orderRemark",query:{id:t.checkoutData.cart.id,sig:t.checkoutData.sig}}}},[e("span",[t._v("订单备注")]),t._v(" "),e("div",{staticClass:"more_type"},[e("span",{staticClass:"ellipsis"},[t._v(t._s(t.remarkText||t.inputText?t.remarklist:"口味、偏好等"))]),t._v(" "),e("svg",{staticClass:"address_empty_right"},[e("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#arrow-right"}})])])]),t._v(" "),e("router-link",{staticClass:"hongbo",class:{support_is_available:t.checkoutData.invoice.is_available},attrs:{to:t.checkoutData.invoice.is_available?"/invoice":""}},[e("span",[t._v("发票抬头")]),t._v(" "),e("span",[t._v("\n        "+t._s(t.invoiceTxt?t.invoiceTxt:t.checkoutData.invoice.status_text)+"\n        "),e("svg",{staticClass:"address_empty_right"},[e("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#arrow-right"}})])])])],1),t._v(" "),e("section",{staticClass:"confrim_order"},[e("p",[t._v("待支付 ¥"+t._s(t.checkoutData.cart.total))]),t._v(" "),e("p",{on:{click:t.confrimOrder}},[t._v("确认下单")])]),t._v(" "),e("transition",{attrs:{name:"fade"}},[t.showPayWay?e("div",{staticClass:"cover",on:{click:t.showPayWayFun}}):t._e()]),t._v(" "),e("transition",{attrs:{name:"slid_up"}},[t.showPayWay?e("div",{staticClass:"choose_type_Container"},[e("header",[t._v("\n        支付方试\n      ")]),t._v(" "),e("ul",t._l(t.checkoutData.payments,function(s){return e("li",{key:s.id,class:{choose:t.payWayId==s.id},on:{click:function(e){t.choosePayWay(s.is_online_payment,s.id,s.name)}}},[e("span",[t._v(t._s(s.name)),s.is_online_payment?t._e():e("span",[t._v(t._s(s.description))])]),t._v(" "),e("svg",{staticClass:"address_empty_right"},[e("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#select"}})])])}))]):t._e()]),t._v(" "),t.showAlert?e("alert-Tip",{attrs:{alertText:t.alertText},on:{closeTip:function(s){t.showAlert=!1}}}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("section",{staticClass:"hongbo"},[s("span",[this._v("红包")]),this._v(" "),s("span",[this._v("暂时只在饿了么 APP 中支持")])])}]},k=e("VU/8")(v,f,!1,function(t){e("qZ2w")},"data-v-0a2e3fd8",null);s.default=k.exports},TmV0:function(t,s,e){e("fZOM"),t.exports=e("FeBl").Object.values},fZOM:function(t,s,e){var a=e("kM2E"),r=e("mbce")(!1);a(a.S,"Object",{values:function(t){return r(t)}})},gRE1:function(t,s,e){t.exports={default:e("TmV0"),__esModule:!0}},mbce:function(t,s,e){var a=e("lktj"),r=e("TcQ7"),i=e("NpIQ").f;t.exports=function(t){return function(s){for(var e,n=r(s),o=a(n),c=o.length,_=0,d=[];c>_;)i.call(n,e=o[_++])&&d.push(t?[e,n[e]]:n[e]);return d}}},qZ2w:function(t,s){}});
//# sourceMappingURL=4.0a20a4da3bd092eef22a.js.map